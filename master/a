This is written from master branch.