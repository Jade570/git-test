This is written from test-branch4.